<!DOCTYPE html>
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.6
Version: 4.5.5
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Dribbble: www.dribbble.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>
<meta charset="utf-8" />
<title>关爱通</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=1" name="viewport" />
<meta content="" name="description" />
<meta content="" name="author" />
<!-- BEGIN GLOBAL MANDATORY STYLES -->
<#include "/admin_sys/head.html"/>


</head>
<!-- END HEAD -->

<body
	class="page-header-fixed page-sidebar-closed-hide-logo page-container-bg-solid page-md">
	<!-- BEGIN HEADER -->
	<#include "/admin_sys/top.html"/>
	<!-- END HEADER -->
	<!-- BEGIN HEADER & CONTENT DIVIDER -->
	<div class="clearfix"></div>
	<!-- END HEADER & CONTENT DIVIDER -->
	<!-- BEGIN CONTAINER -->
	<div class="page-container">
		<!-- BEGIN SIDEBAR -->
		<#assign tb_14=true />
			<#assign tb_14_ul=true  />
			<#assign tb_14_li_2=true />
			<#assign tb_14_arrow=true />
		<#include "/admin_sys/left.html"/>
		<!-- END SIDEBAR -->
		<div class="page-content-wrapper">
			<!-- BEGIN CONTENT BODY -->
			<div style="min-height:1022px" class="page-content">
				<!-- page bar start -->
				<div class="page-bar">

					<ul class="page-breadcrumb">
						<li><a href="javascript:;">维护管理</a> <i class="fa fa-angle-right"></i>
						</li>
						<li><span>添加记录框</span></li>
					</ul>
				</div>
					<div class="row">
					<div class="col-md-12">
						<!-- BEGIN SAMPLE FORM PORTLET-->
						<div class="portlet box red bordered">
							<div class="portlet-title">
								<div class="caption">
									<i class="icon-docs"></i>添加
								</div>
								<div class="tools">
									<a class="collapse" href="" data-original-title="" title="">
									</a> <a class="remove" href="" data-original-title="" title="">
									</a>
								</div>
							</div>
							
				
							
							<div class="portlet-body">

								<form action="A_topName.do" method="post" class="form-inline" id="tableForm" >
										
                                           	<div class="form-group">
                                                                                                                                                             增加顶级分类: <input type="text" class="form-control"  name="name">
                                                    <input type="hidden" name="priority" value="7">
                                           </div>
                                           <input class="btn red" type="submit" value="添加"/>
									<div>
										
										
									</div>
						
								</form>
								<br>
								<form action="v_addAsses_types.do" method="post" class="form-inline" id="tableForm" >
										
                                           	<div class="form-group">
                                                                                                                                                                  增加分类: <input type="text" class="form-control" placeholder="" name="typeName">
                                           </div>
                                           <div class="form-group">所属分类
		                                           <select class="bs-select form-control input-small "  id="typeList" name="category_id"  data-style="btn-primary">
		                                           <option value="">请选择</option>
													 <#list cList as item>
                                                <option value="${item.id}">${item.name}</option>
                                            </#list>
												 </select>
										  </div>
                                           <input class="btn red" type="submit" value="添加"/>
									<div>
										
										
									</div>
									
								</form>
								<br>
								<form action="v_addAsses_Item.do" method="post" class="form-inline" name="myform1">	
                                           	<div class="form-group">
                                                                                                                                                             增加条目: <input type="text" class="form-control"  name="description">
                                           </div>
                                           <div class="form-group">
                                                                                                                                                             分数: <input type="text" class="form-control"  name="grade">
                                           </div>
                                           
                                           
                                            <div class="form-group">所属分类
		                                           <select class="bs-select form-control input-small "  id="typeList1" name="category_id"  data-style="btn-primary">
		                                           <option value="">请选择</option>
													 <#list cList as item>
                                                <option value="${item.id}">${item.name}</option>
                                            </#list>
												 </select>
										  </div>
                                           
                                           <div class="form-group">所属分类
		                                           <select class="bs-select form-control input-small" name="type_id" id="type" data-style="btn-primary">
		                                           <option value="">请选择</option>
													  <#list cList as item>
													   <#if item.types?exists>
													  <#list item.types as types>
													 <option value="${types.id}" >${types.typeName}</option>
													 </#list>
													 </#if>
													 </#list>
													 
												 </select>
										  </div>
                                           <input class="btn red" type="submit" value="添加"/>
									<div>
									</div>
								</form>

							</div>
						
						</div>
						 <#list cList as category>
						<div class="col-md-12">
                            <!-- BEGIN PORTLET-->
                            <div class="portlet light ">
                                <div class="portlet-title">
                                    <div class="caption">
                                        <i class="icon-edit font-dark"></i>
                                        <h2><span class="caption-subject font-dark bold uppercase">${category.name}</span></h2>
                                    </div>
                                    <!-- <div class="actions">
                                        <a class="btn btn-circle btn-icon-only btn-default" href="javascript:;">
                                            <i class="icon-cloud-upload"></i>
                                        </a>
                                        <a class="btn btn-circle btn-icon-only btn-default" href="javascript:;">
                                            <i class="icon-wrench"></i>
                                        </a>
                                        <a class="btn btn-circle btn-icon-only btn-default fullscreen" href="javascript:;"> </a>
                                        <a class="btn btn-circle btn-icon-only btn-default" href="javascript:;">
                                            <i class="icon-trash"></i>
                                        </a>
                                    </div> -->
                                </div>
                                <div class="portlet-body">
                                <#if category.types?exists>
                                <#list category.types as type>
                                     <div class="note note-success">
                                         <h3 class="block">${type.typeName}</h3>
                                        <#if type.assesItems?exists>
                                           <#list type.assesItems as item>
                                            <h5> ${item.description}&nbsp;(${item.grade})分</h5>
                                            <br/>
                                           </#list>
                                        </#if>
                                    </div>
                                 </#list>  
                              </#if> 
                            </div>
                         </div>
					</div>
				</#list>
						<!-- END SAMPLE FORM PORTLET-->
			</div>
				
				</div>
			</div>
		</div>
		<!-- BEGIN CONTENT -->
		
<#include "/common/bootAlert_message.html"/>
		<!-- END CONTENT -->
<script type="text/javascript">
/*
 * 需要思考哪些事情?
 * * 在什么时候执行Ajax的异步请求?
 *   * 当用户选择具体的省份信息时
 */
// 1. 为id为province元素绑定onchange事件
var categoryEle = document.getElementById("typeList1");
categoryEle.onchange = function(){
    // 清空
    var type = document.getElementById("type");
    var opts = type.getElementsByTagName("option");
    for(var z=opts.length-1;z>0;z--){
        type.removeChild(opts[z]);
    }
    
    if(categoryEle.value != "请选择"){
        // 2. 执行Ajax异步请求
        var xhr = getXhr();
        xhr.open("post","v_ajax.do");
        xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
        xhr.send("categoryId="+categoryEle.value);
    }else{
    	var xhr = getXhr();
        xhr.open("post","v_ajax.do");
        xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
        xhr.send("categoryId="+"");
    }
        xhr.onreadystatechange = function(){
            if(xhr.readyState==4&&xhr.status==200){
                // 接收服务器端的数据内容
                var data = xhr.responseText;
                // data是字符串,转换为数组
                var index = data.indexOf("=");
                var AssesTypeNames = data.substring(0, index).split(',');
                var AssesTypeIds = data.substring(index+1).split(',');
                for(var i=0;i<AssesTypeNames.length;i++){
                    var option = document.createElement("option");
                    option.value = AssesTypeIds[i];
                    var textNode = document.createTextNode(AssesTypeNames[i]); 
                    option.appendChild(textNode);
                    type.appendChild(option);
                }
            }
        };
    
};


function getXhr(){
    var xhr = null;
    if(window.XMLHttpRequest){
        xhr = new XMLHttpRequest();
    }else{
        xhr = new ActiveXObject("Microsoft.XMLHttp");
    }
    return xhr;
}
</script>
		<script
			src="${base}/res/assets/global/plugins/jquery-validation/js/jquery.validate.min.js"
			type="text/javascript"></script>
			<script src="${base}/res/assets/global/plugins/jquery-validation/js/localization/messages_zh.js"></script>
		<script
			src="${base}/res/assets/global/plugins/jquery-validation/js/additional-methods.min.js"
			type="text/javascript"></script>
		<script src="${base}/res/assets/js/profile-validation.js"
			type="text/javascript"></script>
	</div>
	<!-- END CONTAINER -->
</body>

</html>